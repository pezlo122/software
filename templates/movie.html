{% extends "base.html" %}
{% block title %}{{ movie.get('title') }}{% endblock %}

{% block content %}

<div class="movie-detail">

    {% if movie.get('poster_path') %}
        <img src="https://image.tmdb.org/t/p/w500{{ movie.get('poster_path') }}" alt="{{ movie.get('title') }}">
    {% elif movie.get('poster') %}
        <img src="{{ movie.get('poster') }}" alt="{{ movie.get('title') }}">
    {% endif %}

    <h2>{{ movie.get('title') }}</h2>

    {% if movie.get('genres') %}
    <div class="movie-genres">
        {% for g in movie.get('genres') %}
            <span class="genre-badge">{{ g.get('name') }}</span>
        {% endfor %}
    </div>
    {% endif %}

    <p>{{ movie.get('overview') or 'Sin descripción' }}</p>

    <!-- ❤️ LIKE BUTTON -->
    <form action="/api/like/{{ movie.get('id') }}" method="post" style="margin-top: 20px;">
        <button class="like-btn">❤️ Me gusta</button>
    </form>

    <p style="margin-top:10px; font-size:18px;">
        ❤️ <strong>{{ likes }}</strong> likes
    </p>

    {% if trailer_key %}
    <div class="trailer-box">
        <h3>Trailer Oficial</h3>
        <iframe width="560" height="315" src="https://www.youtube.com/embed/{{ trailer_key }}" frameborder="0" allowfullscreen></iframe>
    </div>
    {% endif %}

    <div class="recommendations">
        <h3>Recomendadas</h3>
        <div class="recommendation-grid">
            {% for rec in recommendations %}
            <a href="/movie/{{ rec['id'] }}" class="rec-card">
                {% if rec.get('poster_path') %}
                <img src="https://image.tmdb.org/t/p/w300{{ rec.get('poster_path') }}" alt="{{ rec.get('title') }}">
                {% else %}
                <img src="https://via.placeholder.com/300x450?text=No+Image" alt="{{ rec.get('title') }}">
                {% endif %}
                <p>{{ rec.get('title') }}</p>
            </a>
            {% endfor %}
        </div>
    </div>

    <p style="margin-top: 30px;"><a href="/dashboard">⬅ Volver</a></p>
</div>

{% endblock %}
